<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>IB Question Entry – Web</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <div class="page">
      <header class="page-header">
        <h1>IB Question Entry – Web</h1>
        <p class="subtitle">
          AceDiploma
        </p>
      </header>

      <main class="layout">
        <!-- Instructions -->
        <section class="card">
          <div class="instructions-header" id="instructions-header">
            <h2>Instructions</h2>
            <button id="instructions-toggle" class="btn tiny" aria-label="Toggle instructions">
              <span id="instructions-toggle-icon">▲ CLOSE INSTRUCTIONS</span>
            </button>
          </div>
          <div id="instructions-content" class="instructions-content">
            <ul class="instructions-list">
              <li><strong>Subject & Exam Code:</strong> Select a subject and enter an exam code starting with M or N (e.g., M22/1, N23/2, M25A/1).</li>
              <li><strong>Important - One File Per Exam:</strong> You must create a new file for each exam. When you finish entering all questions for an exam: (1) Download the file using "Export CSV (HTML + images)", (2) Keep and send the downloaded file, (3) Click "Clear all entries" before moving on to the next exam.</li>
              <li><strong>Create Sets:</strong> Click "New set" to create question groups. Each set can have a label (e.g., "Question 10") and optional section (A or B).</li>
              <li><strong>Add Questions:</strong> Select a set, enter a path (e.g., "10" or "10.a.i"), choose answer type, and fill in question text and mark scheme.</li>
              <li><strong>Rich Text:</strong> Use Bold, Italic, and Courier buttons to format text. Insert images using the "Insert image" button or drag & drop.</li>
              <li><strong>Answer Types:</strong>
                <ul>
                  <li><strong>Type 0:</strong> Context only (no answer expected) - marks must be 0</li>
                  <li><strong>Type 1:</strong> Open text answer - marks > 0, mark scheme required</li>
                  <li><strong>Type 2:</strong> Multiple choice - marks > 0, mark scheme required</li>
                </ul>
              </li>
              <li><strong>Edit/Copy:</strong> Use Edit to modify existing questions, or Copy to duplicate a question as a new entry.</li>
              <li><strong>Reorder:</strong> Use ↑/↓ buttons or drag & drop to reorder questions within a set.</li>
              <li><strong>Export:</strong> Click "Export CSV (HTML + images)" to download a zip file containing the CSV with HTML formatting and an images folder.</li>
              <li><strong>Auto-save:</strong> Your work is automatically saved to browser storage. Reloading the page will restore your data.</li>
            </ul>
          </div>
        </section>

        <!-- Exam metadata -->
        <section class="card">
          <h2>Exam information</h2>
          <div class="form-grid">
            <label>
              <span>Subject *</span>
              <select id="subject">
                <option>Eng A: Lang and Lit</option>
                <option>Eng A: Literature</option>
                <option>Spanish B</option>
                <option>English B</option>
                <option>History</option>
                <option>Business Management</option>
                <option>Economics</option>
                <option>Psychology</option>
                <option>Biology</option>
                <option>Chemistry</option>
                <option>Physics</option>
                <option>ESS</option>
                <option>Math AA: Analysis and Approaches</option>
                <option>Math AI: Applications and Interpretations</option>
                <option>Computer Science</option>
                <option>Spanish A: Language and Literature</option>
                <option>Spanish A: Literature</option>
              </select>
            </label>

            <label>
              <span>Exam code (e.g. M25) *</span>
              <input id="exam" type="text" placeholder="M22... / N23..." />
            </label>
          </div>
          <p class="muted small">
            Exam code must start with M or N (e.g. M22/1, N23/2, M25A/1, etc.).
          </p>
        </section>

        <!-- Question sets -->
        <section class="card">
          <h2>Question sets</h2>
          <div class="sets-layout">
            <div class="sets-list-container">
              <div class="sets-header">
                <span>Sets</span>
                <button id="btn-new-set" class="btn tiny primary">New set</button>
              </div>
              <ul id="sets-list" class="sets-list"></ul>
            </div>

            <div class="sets-actions">
              <button id="btn-edit-set" class="btn tiny">Edit selected set</button>
              <button id="btn-delete-set" class="btn tiny danger">
                Delete selected set
              </button>
            </div>
          </div>
        </section>

        <!-- Question editor -->
        <section class="card">
          <h2 id="question-form-title">Add question</h2>
          <div class="form-grid">
            <label>
              <span>Current set *</span>
              <select id="q-set-select"></select>
            </label>

            <label>
              <span>Path *</span>
              <input id="q-path" type="text" placeholder="10 or 10.a.i" />
            </label>

            <label>
              <span>Answer type *</span>
              <select id="q-answer-type">
                <option value="0">0 - No answer expected (context only)</option>
                <option value="1">1 - Open text answer</option>
                <option value="2">2 - Multiple choice</option>
              </select>
            </label>

            <label class="checkbox-inline">
              <input id="q-needs-context" type="checkbox" />
              <span>Needs context (type 1)</span>
            </label>

            <label class="marks-field">
              <span>Marks *</span>
              <input id="q-marks" type="number" min="0" max="100" value="0" />
            </label>
          </div>

          <section class="block">
            <div class="editor-header">
              <span>Question text *</span>
              <div class="editor-toolbar" data-target="q-text-editor">
                <button type="button" class="btn tiny" data-cmd="bold">Bold</button>
                <button type="button" class="btn tiny" data-cmd="italic">
                  Italic
                </button>
                <button type="button" class="btn tiny" data-cmd="monospace">
                  Courier
                </button>
                <button type="button" class="btn tiny" data-cmd="normal">
                  Normal
                </button>
                <button
                  type="button"
                  class="btn tiny"
                  data-image-target="q-text-editor"
                >
                  Insert image
                </button>
                <input
                  type="file"
                  accept="image/*"
                  class="image-input"
                  data-editor="q-text-editor"
                  hidden
                />
              </div>
            </div>
            <div
              id="q-text-editor"
              class="rich-editor"
              contenteditable="true"
              data-placeholder="Question text"
            ></div>
          </section>

          <section class="block">
            <div class="editor-header">
              <span>Mark scheme (required for types 1 and 2)</span>
              <div class="editor-toolbar" data-target="q-mark-editor">
                <button type="button" class="btn tiny" data-cmd="bold">Bold</button>
                <button type="button" class="btn tiny" data-cmd="italic">
                  Italic
                </button>
                <button type="button" class="btn tiny" data-cmd="monospace">
                  Courier
                </button>
                <button type="button" class="btn tiny" data-cmd="normal">
                  Normal
                </button>
                <button
                  type="button"
                  class="btn tiny"
                  data-image-target="q-mark-editor"
                >
                  Insert image
                </button>
                <input
                  type="file"
                  accept="image/*"
                  class="image-input"
                  data-editor="q-mark-editor"
                  hidden
                />
              </div>
            </div>
            <div
              id="q-mark-editor"
              class="rich-editor"
              contenteditable="true"
              data-placeholder="Mark scheme text"
            ></div>
          </section>

          <div class="actions-row">
            <button id="btn-add-question" class="btn primary">Add</button>
            <button id="btn-add-continue" class="btn">Add and continue</button>
            <button id="btn-update-question" class="btn primary" hidden>
              Update
            </button>
            <button id="btn-cancel-edit" class="btn" hidden>Cancel edit</button>
          </div>
        </section>

        <!-- Preview tree -->
        <section class="card">
          <h2>Question preview</h2>
          <p id="preview-empty" class="muted">
            No question sets or questions yet.
          </p>
          <div id="preview-container" class="preview-container"></div>

          <div class="actions-row">
            <button id="btn-export-excel" class="btn success" disabled>
              Export CSV (HTML + images)
            </button>
            <button id="btn-clear-all" class="btn danger" disabled>
              Clear all entries
            </button>
            <span id="status" class="status-text"></span>
          </div>
        </section>
      </main>

      <footer class="page-footer">
        <small>
          Runs entirely in the browser. Exported Excel preserves rich text formatting
          and embedded images.
        </small>
      </footer>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script src="script.js"></script>
  </body>
  </html>


